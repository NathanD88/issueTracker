<!DOCTYPE html>
<html>
    <head>
        <title>Issue Tracker</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- react dependencies -->
        <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <!-- boot strap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <!-- custom stylesheet -->
        <link rel="stylesheet" href="public/css/style.css">
    </head>
    <body onload="onload()">
        <header>
            <a href="/" style="margin-top: 0.5em">Issue Tracker (IT)</a>
        </header>
        <div class="card d-flex flex-column p-4 shadow">
            <h2 style="text-align: center;" class="mb-4">login</h2>
            <p id="error" class="error"></p>
            <div class="form-floating mb-3 justify-center">
                <input type="email" class="form-control" id="floatingUser" placeholder="User01">
                <label for="floatingUser">Username</label>
            </div>
            <div class="form-floating mb-3">
                <input type="password" class="form-control" id="floatingPassword" placeholder="Password">
                <label for="floatingPassword">Password</label>
            </div>
            <button class="btn-primary rounded" onclick="login()">login</button>
        </div>

        <script>

            const _username = document.querySelector("#floatingUser");
            const _password = document.querySelector("#floatingPassword");
            const _error = document.querySelector("#error");

            const onload = () => {
                const token = window.sessionStorage.getItem("token");
                if(token){
                    return console.log("validating token")
                }
                return console.log("no token, please login")
            }

            const login = () => {
                fetch('/app/login', {
                    method: 'POST',
                    headers: { "Content-Type":"application/json" },
                    body: JSON.stringify({username: _username.value, password: _password.value})
                })
                .then(response => response.json())
                .then(result => {
                    console.log(result)
                    const {error} = result;
                    if(error){
                        _error.innerHTML = `*${error}*`;
                    }
                })
            }
        </script>
    </body>
</html>